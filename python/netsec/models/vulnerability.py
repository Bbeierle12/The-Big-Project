"""Vulnerability model."""
from __future__ import annotations

from typing import Optional

from sqlalchemy import Float, String, Text, JSON
from sqlalchemy.orm import Mapped, mapped_column

from netsec.models.base import Base


class Vulnerability(Base):
    __tablename__ = "vulnerabilities"

    title: Mapped[str] = mapped_column(String(500))
    description: Mapped[Optional[str]] = mapped_column(Text)
    cve_id: Mapped[Optional[str]] = mapped_column(String(20), index=True)
    cvss_score: Mapped[Optional[float]] = mapped_column(Float)
    severity: Mapped[str] = mapped_column(String(20), index=True)
    status: Mapped[str] = mapped_column(String(20), default="open", index=True)
    device_id: Mapped[Optional[str]] = mapped_column(String(32), index=True)
    device_ip: Mapped[Optional[str]] = mapped_column(String(45))
    port: Mapped[Optional[int]] = mapped_column()
    service: Mapped[Optional[str]] = mapped_column(String(100))
    source_tool: Mapped[str] = mapped_column(String(50))
    solution: Mapped[Optional[str]] = mapped_column(Text)
    references: Mapped[Optional[dict]] = mapped_column(JSON)
